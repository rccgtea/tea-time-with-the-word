rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Meta collection contains daily scriptures and themes
    match /meta/{document} {
      // Anyone can read the daily scriptures and themes
      allow read: if true;
      
      // Only allow writes from Firebase Functions (for daily scripture generation)
      // or authenticated admin users (for theme management)
      allow write: if (
        request.auth != null && 
        (
          // Allow Firebase Functions service account
          request.auth.token.firebase.sign_in_provider == 'custom' ||
          // Or allow specific admin UIDs - replace with your admin user IDs
          request.auth.uid in ['ADMIN_UID_1', 'ADMIN_UID_2']
        )
      );
    }

    // Deny access to all other collections by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}